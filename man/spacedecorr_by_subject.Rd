% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spacedecorr_by_subject.R
\name{spacedecorr_by_subject}
\alias{spacedecorr_by_subject}
\title{Run SpaceDecorr separately for each subject}
\usage{
spacedecorr_by_subject(
  assay_matrix,
  metadata,
  subject_col = "subject",
  return = c("combined", "list", "both"),
  min_cells = 50,
  ...
)
}
\arguments{
\item{assay_matrix}{Numeric matrix, ideally cells x genes.}

\item{metadata}{Data.frame with one row per cell.}

\item{subject_col}{Column name in metadata indicating subject ID.}

\item{return}{One of "combined", "list", or "both".}

\item{min_cells}{Minimum number of cells required per subject; smaller subjects are skipped.}

\item{...}{Additional arguments passed to \code{spacedecorr()}.}
}
\value{
Depending on \code{return}:
\itemize{
\item "combined": list with \code{residuals} (matrix) and \code{metadata} (data.frame)
\item "list": named list of \code{spacedecorr_fit} objects
\item "both": list with \code{combined} and \code{fits}
}
}
\description{
Splits cells by subject and runs \code{spacedecorr()} within each subject.
}
